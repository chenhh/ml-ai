# 貝氏機率

## 頻率派與貝氏派的思考方法

貝葉斯統計的優勢在於在資料較少的情況下，也可以進行推論，且資料越多，推論結果越準確。以及對所獲得的資訊可做出即時反應，自動升級「推論」的學習功能。

貝葉斯公式中，包含了先驗機率(主觀機率)，因此在頻率學派(客觀機率)中不易被接受。

1. 通過經驗(主觀)設定先驗機率(prob. of hypothesis, P(H))。
2. 觀察不同假設下事件發生的機率(likelihood, P(data/H))。

共同點： 兩派都承認樣本有機率分佈，且分佈的計算方法有相同的準則。

相異點：頻率派把未知參數$$\theta$$看成一個固定量，而貝氏派將$$\theta$$視為隨機變數，且隨機變數的分佈隨著觀察到的資料而調整。

## 貝氏主義者認為機率是長期的平均數嗎？

<mark style="color:red;">貝氏機率的精神在於會隨著新的資料(証據)，而不斷更新之前的信念(先驗機率)，保留不確定性，很少會做出絕對的判斷</mark>。

<mark style="color:red;">頻率學派將機率視為長時間內事件發生的頻率</mark>。但對於沒有長期頻率的事件難以解釋，例如選舉中某侯選人勝選的機率，但選舉只選一次。

* 因此頻率學派採用替代現實的想法，即在許多個平行世界中有多次選舉，侯選人勝選的次數比例(客觀)。
* 貝式學派將勝選的機率解釋為選勝的信心(主觀)。

頻率派把需要推論的參數(向量)$$\theta$$看成固定的未知參數。即$$\theta$$是未知的固定值。同時樣本$$X$$是隨機變數，所以頻率學派研究樣本空間，大部份的機率都是討論樣本$$X$$的分佈。

貝氏學派認為參數$$\theta$$是隨機變數，而樣本$$X$$是已觀察到的固定實現值，因此研究重點是$$\theta$$的分佈。

* 先驗分佈$$\mathrm{P}(\theta)$$+ 樣本資訊$$X$$=後驗分佈$$\mathrm{P}(\theta~|~X)$$。

貝氏統計的優勢在於，「在資料較少的情況下也可以進行推論，且資料越多，推論結果越準確」，以及「對所獲的信息可做出瞬時反應，自動升級推論」的學習功能。


## 貝氏統計推論中所使用的三種資訊

統計推論的主要任務是使用樣本估計總體。樣本有兩重性：

* 當樣本視為隨機變數時，它有機率分佈，稱為總體分佈。如果已經知道總體的分佈形式，則樣本提供了我們<mark style="color:red;">總體資訊</mark>。如已知樣本為常態分佈時，可知道樣本的形狀等資訊。但獲取總體的資訊要付出許多成本。
* 另一種資訊為<mark style="color:red;">樣本資訊</mark>，就是從總體中抽出的樣本所提供的資訊。樣本越多，提供的資訊越多。我們希望通過對樣本的加工、整理、對總體的分佈和某些特徵做出統計推論。

<mark style="color:blue;">總體資訊和樣本資訊</mark>放在一起時，稱為抽樣資訊(sampling information)。而以抽樣資訊進行統計推論的方法稱為<mark style="color:blue;">經典(古典)統計學(classical statistics)</mark>。其基本觀點時將樣本看成來自有一定機率分佈的總體，所研究的對象是這個總體而不限於資料本身。

另一種資訊為<mark style="color:red;">先驗資訊(prior information)</mark>，就是在抽樣之前，有關統計推論問題中未知參數的一些資訊，一般來自於經驗或歷史資料。

基於<mark style="color:blue;">總體資訊、樣本資訊和先驗資訊</mark>進行統計推論的方法稱為<mark style="color:blue;">貝氏統計學(Bayesian statistics)</mark>。其於經典統計學的主要區別在於是否使用先驗資訊，且在使用樣本中也存在差異。

* 貝氏方法重視已觀察到的樣本，不考慮尚未發生的樣本。
* 貝氏統計重視先驗資訊的收集，使其形成先驗分佈加到統計推論中。

## 先驗、似然、後驗機率(prior, likelihood, posterior probability)

在貝式統計中，一個隨機事件或者一個不確定事件的後驗機率是在考慮和給出相關證據或數據後所得到的條件機率。
同樣，後驗機率分布是一個未知量（視為隨機變量）基於試驗和調查後得到的機率分佈。

**「後驗」在此中代表考慮了被測試事件的相關證據**。

* 後驗機率(posterior probability)是隨機變數$$\theta$$且先驗分佈為$$\mathrm{P}(\theta)$$，在給定證據(evidence) $$X$$後的條件機率：$$\mathrm{P}(\theta \vert X)$$。
* 與似然函數(likelihood function)相反，其為證據$$X$$給定了參數$$\theta$$後的機率：$$\mathrm{P}(X \vert \theta)$$。
* 首先定義統計模型參數$$\theta$$，將$$\theta$$視為隨機變數，且在觀察到樣本之前，分配一個機率分佈給$$\theta$$稱為先驗分佈(prior distribution)，記為$$\mathrm{P}(\theta)$$<mark style="color:blue;">。當樣本足夠多時，先驗分佈的選取就不重要了</mark>。但實際上，選擇一個恰當的先驗分佈能夠大大地節省後驗分佈的計算時間，甚至可以匯出後驗分佈的解析表示式。

則樣本在此參數的可能性為$$\mathrm{P}(X|\theta)$$，因此使用貝式定理得後驗機率為：

$$
\mathrm{P}(\theta | X)=\frac{\mathrm{P}(\theta, X)}{\mathrm{P}(X)}=\frac{\mathrm{P}(X|\theta)\mathrm{P}(\theta)}{\mathrm{P}(X)}=\frac{(X|\theta)\mathrm{P}(\theta)}{\int_{\theta^{'}}\mathrm{P}(X| \theta^{'})\mathrm{P}(\theta^{'})d\theta^{'}}
$$

* 後驗機率可以寫成更易記憶的形式，為後驗機率(posterior probability) ∝可能性(likelihood)×先驗機率(prior probability)。
* Posterior = ( Likelihood \* Prior ) /  Evidence。

通常先驗概率可通過經驗來判斷；在特殊情況下，即使沒有類似經驗，也可以進行判斷。「事前」的含義是：在獲得某項信息之前。此處的信息 是指：附加的狀況 。

## 簡單範例：顧客是買東西還是逛逛而已

推算的第一步：將兩種顧客（來買東西的顧客(A)、隨便逛逛的顧客(B)）的比例進行數值分配(先驗機率)。假設買東西和隨便逛逛顧客機率分別為20%: 80% (先驗機率$$\mathrm{P}(A)=0.2,~\mathrm{P}(B)=0.2$$)。

第二步是觀察資料，得到兩類人(買東西:隨便逛逛)分別向店員循問(事件$$X$$)的機率分別為90%與30%(似然率$$\mathrm{P}(X~|~A)=0.9,~\mathrm{P}(X~|~B)=0.3$$)。

| 類別        | 循問店員的機率  | 不問店員的機率  |
| --------- | -------- | -------- |
| 買東西的人(A)  | 20%\*90% | 20%\*10% |
| 隨便逛逛的人(B) | 80%\*30% | 80%\*70% |

上表可得四種聯合機率(宇集合)：

* P(買東西的人且循問店員)=P(X,A)=20%\*90%=18%
* P(買東西的人且不循問店員)=P(\~X, A)=20%\*10%=2%
* P(隨便逛逛的人且循問店員)=P(X,B)=80%\*30%=24%
* P(隨便逛逛的人且不循問店員)=P(\~X, B)=80%\*70%=56%

在現實生活中，若店員遇到客人來循問店員(新增訊息)，則此時可將不問店員的事件排除，因此只剩兩種情況：

* P(買東西的人|循問店員)=20%\*90%=0.18
* P(隨便逛狂的人|循問店員)=80%\*30%=0.24

正規化後(後驗機率$$\mathrm{P}(A~|~X)~\mathrm{P}(B~|~X)$$)，<mark style="color:red;">可判定循問店員的人屬於隨便逛逛類型的機率較高</mark>。

* P(買東西的人|循問店員)=0.18/(0.24+0.18)=42.9%
* P(隨便逛逛的人|循問店員)=0.24/(0.24+0.18)=57.1%

#### 貝氏推論過程

1. 關於類別的先驗機率
2. 關於類別的條件機率
3. 對行為的觀察
4. 排除不可能的情形
5. 類別的機率正規化
6. 得到後驗機率
