# Beta-binomial共軛分佈

先驗、後驗分佈：beta

資料分佈：binomial

在貝氏統計中，Beta-binomial共軛分佈描述了一個這樣的場景：

* 我們對一個事件發生的機率並不完全確定，因此我們給這個機率賦予一個Beta分佈作為先驗分佈。
* 然後，我們進行了一系列伯努利試驗，得到了一定的資料，基於這些資料，我們可以更新對該機率的信念，得到一個後驗分佈。
* 神奇的是，這個後驗分佈仍然是一個Beta分佈，這就是Beta-binomial共軛關係。

### beta-binomial共軛分佈的解釋

*   **數學上的便利：** 後驗分佈的表示式與先驗分佈的形式非常相似，便於計算和分析。

    **參數更新**：先驗分佈的參數 $$\alpha$$ 和 $$\beta$$ 分別加上了成功的次數 $$x$$ 和失敗的次數 $$n-x$$。
* **直觀的解釋：** 後驗分佈的引數$$\alpha+x$$和$$\beta+n-x$$分別對應於成功次數和失敗次數的更新. 保留了 Beta 分佈的形式，只是參數發生了變化，反映了資料對我們信念的影響。
* **迭代更新：** 當有新的資料到來時，我們可以將新的成功次數和失敗次數加到後驗分佈的引數中，得到新的後驗分佈，實現了貝葉斯更新。

### 應用場景

Beta-binomial共軛分佈在很多領域都有應用，例如：

* **A/B測試：** 比較兩個版本的效果時，可以將點選率建模為Beta-binomial分佈。
* **生物統計：** 分析二項分佈資料時，可以採用Beta-binomial模型。
* **自然語言處理：** 在主題模型中，可以將詞頻建模為Beta-binomial分佈。

## 先驗分佈：Beta分佈

假設我們對一個事件發生的機率θ並不完全確定，我們用Beta分佈來描述我們對θ的先驗知識：

$$\theta \sim Beta(\alpha, \beta)$$

其中α和β是Beta分佈的引數，控制著分佈的形狀。

## 似然函數：二項分佈

我們進行了$$n$$次伯努利試驗，其中有$$x$$次成功，則似然函式為：$$\mathrm{P}(X=x|\theta)=\binom{n}{x}\theta^x (1-\theta)^{n-x}$$。

## 後驗分佈：Beta分佈

根據貝氏定理，後驗分佈正比於先驗分佈乘以似然函式：$$\mathrm{P}(\theta|x) \propto \mathrm{P}(x|\theta)  \times \mathrm{P}(\theta)$$。

將Beta分佈和二項分佈代入，經過一系列的推導和化簡，可以得到：$$P(\theta|x) \propto \theta^{x+\alpha-1} \times (1-\theta)^{n-x+\beta-1}$$。

可以看出，後驗分佈仍然是一個Beta分佈，其引數為$$(\alpha+x, \beta+n-x)$$。

