---
description: sequential rationality
---

# 序貫理性

序貫理性就是指:即使不同時使用資訊，而是逐步地(依次地)使用，也能夠得出相同的結果。
換言之就是「即使忘記了之前使用過的資訊也沒問題」的意思。這是因為它在後驗機率中得到了體現，而如果
後驗概率視為先驗概率，只要進行新的推理，結果就不會發生變化。 

這也可以說是一種學習功能。貝氏推理中,修改過的「各個類別的後驗機率」，已經使用了所有的資訊。也
是說我們可以將其看作「從資訊中學習到的結果」。

因此貝氏推論還具備了「資訊越多，推理結果就越精確」 的性質。


## 範例：掃瞄垃圾郵件

先驗機率：在沒有資訊前，一般郵件(A)和垃圾郵件(B)的先驗機率相等，即$$\mathrm{P}(A)=\mathrm{P}(B)=0.5$$。

### 以超連結判斷

判斷是否為垃圾郵件，可從郵件是否含有超連結做簡單判斷：

* 垃圾郵件中，有超連結的條件機率為0.6。
* 正常郵件中，有超連結的條件機率為0.2。

因此可得聯合分佈：

|         | 有超連結             | 無超連結        |
| ------- | ---------------- | ---------------- |
| 垃圾郵件(B) | 0.5 \* 0.6 = 0.3 | 0.5 \* 0.4 = 0.2 |
| 正常郵件(A) | 0.5 \* 0.2 = 0.1 | 0.5 \* 0.8 = 0.4 |

如果收到的郵件有超連結時，則可去掉無超連結的情形，得後驗機率：

* $$\mathrm{P}(A|X)= \frac{0.1}{0.4} = 0.25$$
* $$\mathrm{P}(B|X)= \frac{0.3}{0.4} = 0.75$$

因此判斷為垃圾郵件的機率為75%。

### 以關鍵字判斷

判斷是否為垃圾郵件，也可從郵件是否含有關鍵字幽會做簡單判斷：

* 垃圾郵件中，有幽會關鍵字的條件機率為0.4。
* 正常郵件中，有幽會關鍵字的條件機率為0.05。

可聯合超連結($$X$$)和幽會關鍵字($$Y$$)做判斷得聯合分佈：


|      | 有超連結且有幽會 | 有超連結且沒有幽會 | 無超連結且有幽會 | 無超連結且沒有幽會 |
|----|---------------|-----------------|---------------|-----------------|
| 垃圾郵件(B) | 0.5 \* 0.6 \* 0.4  | 0.5 \* 0.6 \* 0.6  | 0.5 \* 0.4 \* 0.4  | 0.5 \* 0.4 \* 0.6   | 
| 正常郵件(A) | 0.5 \* 0.2 \* 0.05 | 0.5 \* 0.2 \* 0.95 | 0.5 \* 0.8 \* 0.05 | 0.5 \* 0.8 \* 0.95  |



已知郵件有連結，且有幽會關鍵字時的情形時：
* 垃圾郵件: $$ \mathrm{P}(B|X,Y) = 0.5 \times 0.6 \times 0.4 = 0.12 $$
* 正常郵件: $$ \mathrm{P}(A|X,Y) = 0.5 \times 0.2 \times 0.05 = 0.005 $$

正規化後得後驗機率：
* $$ \mathrm{P}(X,Y|B) = \frac{0.12}{0.12+0.005} = 0.96 $$
* $$ \mathrm{P}(X,Y|A) = \frac{0.005}{0.12+0.005} = 0.04 $$

因此有連結且有幽會關鍵字的郵件為垃圾郵件的機率為96%。

### 在貝氏推理中可以依次使用資訊得到相同的結果

上述同時使用超連結與關鍵字判斷垃圾郵件的方式，等價於先使用超連結判斷是否為垃圾郵件的後驗分佈，
做為關鍵字的先驗分佈後，再使用貝氏推理的後驗分佈機率。

* 即 A,B的先驗分佈 -> 同時使用資訊X, Y後 -> A,B的後驗分佈
* 等價於A,B的先驗分佈 ->使用資訊X後-> A,B的後驗分佈 -> 做為下一輪的先驗分佈 -> 使用資訊Y後 -> A,B的後驗分佈

由前面結果可得已知有超連結$$X$$時，A,B的後驗分佈為：
* $$\mathrm{P}(A|X)= \frac{0.1}{0.4} = 0.25$$
* $$\mathrm{P}(B|X)= \frac{0.3}{0.4} = 0.75$$

將此後驗分佈做為下一輪推論的先驗分佈得$$ \mathrm{P}(A)=0.25$$, $$ \mathrm{P}(B)=0.75$$。

由幽會關鍵字($$Y$$)做判斷得聯合分佈：

|         | 有關鍵字                  | 無關鍵字                  |
| ------- |-----------------------|-----------------------|
| 垃圾郵件(B) | 0.75 \* 0.4 = 0.3     | 0.75 \* 0.6 = 0.45    |
| 正常郵件(A) | 0.25 \* 0.05 = 0.0125 | 0.25 \* 0.95 = 0.2375 |

因此若有關鍵字時，可得後驗分佈：
* $$ \mathrm{P}(Y|B) = \frac{0.3}{0.3+0.0125} = 0.96 $$
* $$ \mathrm{P}(Y|A) = \frac{0.005}{0.3+0.125} = 0.04 $$

此序貫結果與同時使用超連結和關鍵字時相同。

## 範例：貝氏推論求黑壺或白壺

有兩外表相同的壺，A壺中有9個白球1個黑球，B壺中有1個白球9個黑球。現在面前有一未知類別的壺，
第一輪抽出的球為黑球，則此壺為A或B壺?

先驗機率：因為無法從外表分辨壺，因此令$$ \mathrm{P}(A)=0.5$$， $$ \mathrm{P}(B)=0.5$$。

已知抽出黑球，正規化後得後驗機率
* $$ \mathrm{P}(Black|A)  = \frac{0.05}{0.05+0.4}=1/9=11.11\%$$
* $$ \mathrm{P}(Black|B)  = \frac{0.4}{0.05+0.4}=8/9=88.89\%$$

假設其先驗機率為：$$ \mathrm{P}(A)=1/9$$， $$ \mathrm{P}(B)=8/9$$。

聯合分佈：
* $$ \mathrm{P}(A， Black) = 1/9 * 0.1 = 1/90$$
* $$ \mathrm{P}(A， White) = 1/9 * 0.9 = 9/90$$
* $$ \mathrm{P}(B， Black) = 8/9 * 0.8 = 64/90$$
* $$ \mathrm{P}(B， White) = 8/9 * 0.2 = 16/90$$

第二輪抽出的球也是黑球，正規化後得後驗機率
* $$ \mathrm{P}(Black|A)  = \frac{1}{1+64}=1/65$$
* $$ \mathrm{P}(Black|B)  = \frac{64}{1+64}=64/65$$

反之如果第二輪抽出的是白球時，正規化後得後驗機率
* $$ \mathrm{P}(White|A)  = \frac{9}{9+16}=9/25$$
* $$ \mathrm{P}(White|B)  = \frac{16}{9+16}=16/25$$

觀察次數越多，推算結果就越接近實際。
