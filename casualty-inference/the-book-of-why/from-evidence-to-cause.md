# 從證據到原因

## 貝式網路（Bayesian network）

演繹：從假設到證據（下至上）。歸納：由證據產生假設（上至下）。福爾摩斯：「排除所有不可能之後，剩下的即使再不可能，也一定是真相」。

貝式網路的應用：語音辨識、垃圾郵件過濾、氣象預報、探勘油井等。

**因果圖和貝式網路的關係很簡單，因果圖就是貝式網路**。圖中的箭頭代表直接或可能存在的因果關係，以箭頭方向為準。貝式網路不一定有因果性，但如果要分析第二、三層的關係時，就要注意因果性。

P\(證據\|假設\)：正機率；P\(假設\|證據\)：逆機率（因果）。如果已經知道原因，大多數人都很容易預料到結果。例如把球丟向窗戶，窗戶應該會被球打破。但如果已知道到結果，則需要更多資訊才能知道原因。如窗戶被打破，還需要知道被什麼打破才能推出原因。

### 貝式定理

> $$\mathrm{P}(X|Y)\mathrm{P}(Y) = \mathrm{P}(Y|X)\mathrm{P}(X)$$或
>
> $$\mathrm{P}(X|Y) = \frac{\mathrm{P}(X,Y)}{\mathrm{P}(Y)}$$

$$\mathrm{P}(X|Y) = \frac{\mathrm{P}(X,Y)}{\mathrm{P}(Y)} = \frac{\mathrm{P}(Y|X)\mathrm{P}(X)}{\mathrm{P}(Y)}$$\(QED\)

我們也可以使用貝式定理隨時更新對某個假設的置信程度。但此處的置信程度是（主觀）的機率，即不同人對於相同的事件會有相異的主觀機率。

貝式定理為依據證據更新假設的基準法則。一個人發現$$X$$之後，對$$Y$$的置信度，永遠不低於他發現$$X$$之前對$$X$$和$$Y$$的置信度。

證據$$Y$$越驚奇（也就是$$P(Y)$$越小），則更應該相信他的原因$$X$$。

### 乳房X光的案例

40歲女性接受乳房X光，檢查是否得乳癌，檢驗結果為陽性。

假設$$D$$為得癌症，證據$$T$$是檢驗的結果。

\(D更新後的機率\) = P\(D\|T\) = \(概似比\) \*\( D的事前機率\)

