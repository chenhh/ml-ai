# 循環子空間\(cyclic subspace\)

## 循環子空間\(cyclic subspace\)

> 線性轉換$$T \in L(V,V), ~v \in V$$
>
> * 稱$$W=span\{v,T(v),T^2 (v),\dots,T^k (v),\dots\}$$為向量$$v$$生成的$$T$$-循環子空間\(T-cyclic subspace generated by v\)，記為$$C_v (T)$$。
> * 稱$$A \in F^{N \times N}$$ 由向量$$x$$生成的循環子空間為$$C_x (A)=span\{x,Ax,A^2 x,\dots\}$$。

> 循環子空間定義中生成集元素的個數是無窮大，因此必須是線性轉換$$T$$經過有限次轉換後收斂，如指標為$$k$$的冪零算子或、值域穩定的算子（如投影算子）、或是使用線性轉換$$T$$的特徵向量$$v$$，才能夠得到有限個元素為生成集的循環子空間。
>
> 另一種定義法：
>
> * $$C_v (T)=\{f(T)(v)|f(x)∈F[x]\}$$
> * 因為$$f(x)∈F[x]$$為多項式，所以$$f(x)=span\{1,x,x^2,x^3,\dots\}$$，因此$$f(T) \in span\{I,T,T^2,\dots\}$$。
> * 所以$$f(T)(v) \in span\{I(v), T(v),T^2 (v),\dots\}$$與上述定義等價。

> 指標$$k$$的冪零算子$$T$$必存在$$k-1$$次線性轉換形成的線性獨立集，因此冪零算子可做出循環子空間。

*  $$若v=0$$，則$$C_v (T)=span\{0, T(0),T^2 (0),\dots\}=span\{0,0,\dots\}=\{0\}$$，反之亦成立。
  * 所以$$v=0\Leftrightarrow C_v (T)=\{0\} \Leftrightarrow \dim⁡(C_V (T))=0$$
* $$C_v (T)$$為$$V$$的子空間。

#### 範例

* $$T(x,y,z)=(-y+z, x+z, 3z)$$，由$$e_1=(1,0,0)$$生成的循環子空間為：
  * $$T(e_1)=(0,1,0)=e_2$$
  * $$T^2(e_1)=T(e_2)=(-1,0,0)=-e_1$$
  * 可得$$Cv(T)=span\{e_1, T(e_1), T^2(e_1), \dots\}=span\{e_1, e_2\}$$

### 循環子空間是T不變子空間

> 線性轉換$$T \in L(V,V), ~ v \in V$$，則$$C_v (T)$$為$$T$$不變子空間 （即 $$T(C_v (T))\subseteq C_v (T)$$）。

Proof:

* 因為$$C_v (T)$$為$$V$$的子空間，因此只要證明$$T(C_v (T)) \subseteq C_v (T)$$，即證明使用$$C_v (T)$$的生成集可生成$$T(C_v (T))$$。
* $$\forall  u \in C_v (T)$$
* $$u=a_{i1} T^{i1} (v)+a_{i2} T^{i2} (v)+\dots+a_{ik} T^{ik} (v), ~a_{i1},a_{i2},\dots,a_{ik} \in F$$
* 所以$$T(u)=T(a_{i1} T^{i1} (v)+a_{i2} T^{i2} (v)+\dots+a_{ik} T^{ik} (v))=a_{i1} T^{i1+1} (v)+a_{i2} T^{i2+1} (v)+\dots+a_{ik} T^{ik+1} (v) \in span\{v, T(v),T^2 (v),\dots\}$$
* 所以$$T(u) \in C_v (T) \Rightarrow T(C_v (T)) \subseteq C_v (T)$$  \(QED\).

### 特徵向量生成的循環子空間維為1

> 線性轉換$$T \in L(V,V)$$
>
> 則$$\dim⁡(C_v (T))=1\Leftrightarrow  v \in V$$為$$T$$的特徵向量。

Proof: =&gt;

* $$\dim⁡(C_v (T))=\dim⁡(span\{v,T(v),T^2 (v),\dots\})=1$$
* 所以$$v \neq 0$$ 且$$C_v (T)=span\{v\}$$
* 依循環子空間的定義得$$T(v) \in C_v (T)$$，即$$\exists \lambda  \in F \ni T(v)=\lambda v$$
* 所以$$v$$為$$T$$的特徵向量 \(QED\)

Proof &lt;=

* 因為$$v$$為$$T$$的特徵向量，所以$$v \neq 0$$且$$\exists \lambda \in F \ni T(v)=\lambda v$$。
* 可得$$C_v (T)=span\{v,T(v),T^2 (v),\dots \}=span\{v,\lambda v,\lambda^2 v,\dots\}=span\{v\}$$
* 所以$$\dim⁡(C_v (T))=1$$ \(QED\)

###  循環子空間的基底與線性變換矩陣表示法

> 線性轉換$$T \in L(V,V)$$，
>
> * 若$$v \neq 0$$且$$v \in ker⁡(T^k )−ker⁡(T^{k−1})$$（即$$T^k (v)=0$$，但$$T^(k−1) (v) \neq 0$$）
> * 則$$B=\{v,T(v),\dots, T^{k−1} (v)\}$$為$$W=C_v (T)$$的一組基底$$\dim⁡(C_V (T))=k$$，且
> * $$[T_{C_v(T)}]_B=S_k=\begin{bmatrix} 0 & 0 & 0  & 0 \\ 1 & 0 & \ddots & 0 \\ 0 & 1 & 0 & 0 \\ 0 & 0 & 1 & 0  \end{bmatrix}_{k \times k}$$為$$k$$階下移矩陣，  稱$$B$$為$$W$$的循環基底\(cyclic basis\)。
> * 若基底$$B=\{T^{k−1} (v),T^{k−2} (v), \dots,T(v),v\}$$，則$$[T_{C_V (T)} ]=S_k^\top$$ 為上移矩陣。

Proof:

* $$v \in ker⁡(T^k )−ker⁡(T^{k−1} )$$，即$$T^k (v)=0$$且$$T^{k−1} (v) \neq 0$$。
* 所以$$T^k (v)=T^{k+1} (v)=\dots=0$$。
* $$W=C_V (T)=span\{v,T(v),T^2 (v),\dots,T^{k−1} (v),0,0,\dots\}=span(B)$$
* 根據[指標k的冪零算子必存在k-1次線性轉換形成的線性獨立集](nilpotent-operator.md#zhi-biaokde-mi-ling-suan-zi-bi-cun-zaik1-ci-xian-xing-zhuan-huan-xing-cheng-de-xian-xing-du-li-ji)，	可知$$B$$為線性獨立集，因此$$B$$為基底。\(QED\)
* 因為$$C_v (T)$$為$$T$$不變子空間，所以$$T_{C_v (T)}$$有定義。
* $$T_{C_v (T) } (v)=T(v)=0v+1T(v)+0T^2 (v)+\dots+0T^{k−1} (v)$$
* $$T_{C_v (T)} (T(v))=T(T(v))=T^2 (v)=0v+0T(v)+1T^2 (v)+\dots+0T^{k−1} (v)$$
* $$\vdots$$
* $$T_{C_v (T) } (T^{k−2} (v))=T(T^{k−2} (v))=T^{k−1} (v)=0v+0T(v)+1T^2 (v)+\dots+1T^{k−1} (v)$$
* $$T_{C_v (T)} (T^{k−1} (v))=T(T^{k−1} (v))=T^k (v)=0$$
* 所以$$[T_{C_v (T) } ]_B=S_k$$  \(QED\)

### 由維度求循環子空間的基底，T可為任意非零的線性算子

> 線性轉換$$ T \in L(V,V)$$，$$ 0 \neq v \in V, ~ W=C_v (T)$$。
>
> 若$$\dim⁡(C_v (T))=k$$，則$$B=\{v,T(v),\dots, T^{k−1} (v)\}$$為$$C_v (T)$$的一組基底。
>
> 此定理由$$\dim⁡(C_v (T))=k$$限制循環子空間生成集元素的個數為$$k$$個，此時$$T^k (v)$$未必為0，可能是由$$v,T(v), \dots,T^{k−1} (v)$$線性組合即可產生的空間。

Proof:

* 令$$j \in \mathbb{N}$$為$$R=\{v,T(v),T^2 (v),\dots,T^{j−1} (v)\}$$為線性獨立集的最大正整數。
* 因為$$v \neq 0$$，所以$$j$$至少為$$1$$，即$$\{v\}$$為線性獨立集。
* 令$$X=span\{R\}$$，則$$R$$為$$X$$的一組基底。
* 因為$$j$$為集合$$R$$線性獨立的最大正整數，所以$$\{v,T(v),\dots,T^{j−1} (v),T^j (v)\}$$為線性相依集。
* $$T^j (v) \in span\{R\}=X$$。



* 要證明$$T(X) \subseteq X$$，即證明$$X$$為$$T$$不變子空間。
* $$\forall x∈X, ~\exists a_0,a_1,\dots ,a_{j−1} \in F \ni x=a_0 v+a_1 T(v)+\dots+a_{j−1} T^{k−1} (v)$$
* 所以$$T(x)=T(a_0 v+a_1 T(v)+\dots+a_{j−1} T^{k−1} (v))=a_0 T(v)+a_1 T^2 (v)+\dots a_{j−1} T^j (v) \in X$$
* 可得$$T(X) \subseteq X$$



* 要證明$$C_v (T) \subseteq X$$
* 因為$$v \in X$$且$$X$$為$$T$$不變子空間，所以$$T(v) \in X$$。
* 所以$$T(T(v))=T^2 (v) \in X$$，以此類推得$$T(T^2 (v))=T^3 (v) \in X$$
* 同理可得$$T^i (v) \in X, ~i=0,1,2,\dots$$
* 所以$$\{v,T(v),T^2 (v),\dots\} \subseteq X$$
* 因為$$C_v (T)=span\{v,T(v),T^2 (v),\dots\}$$為包含$$\{v,T(v),T^2 (v),\dots\}$$的最小子空間，  所以$$C_V (T) \subseteq X$$
* 因為$$X=span\{R\} \subseteq span\{v,T(v),T^2 (v),\dots\}=C_V (T)$$
* 所以$$C_V (T)=X$$
* 因此$$R=\{v,T(v),\dots,T^{j−1} (v), T^j(v)\}$$為$$C_V (T)$$的一組基底
* 因為$$\dim⁡(C_V (T))=k$$，所以$$j=k$$。
* 得$$B=\{v,T(v),\dots,T^{k−2} (v),T^{k-1} (v)\}$$為$$C_V (T)$$的一組基底 \(QED\)

### 線性轉換$$T$$在此定理中未必為冪零算子

> 只要保證$$\dim⁡(C_v (T))=k$$，即可保證$$B$$為$$C_v (T)$$的基底，此時$$T^k (v)$$未必為0。

* 令$$T^k(v)=-a_0v+(-a_1)T(v)+\dots + (-a_{k-1})T^{k-1}(v)$$
* 所以$$A=[T_{C_V(T)}]_B=\begin{bmatrix}  0 & 0 & \dots & 0 & -a_0 \\ 1 & 0 & \dots & 0 & -a_1 \\ 0 & 1 & \dots & 0 & -a_2 \\ \vdots & \vdots & \ddots & \vdots & \vdots \\ 0 & 0 & \dots & 1 & -a_{k-1} \end{bmatrix}$$
* $$char_A(x)=(-1)^k(a_0+a_1x+a_2x^2 + \dots +a_{k-1}x^{k-1} + x^k)$$
* 當$$T^k(v)=0$$時，此時$$a_0=a_1=\dots =a_{k-1}=0 \Rightarrow A=S_k$$為下移矩陣。



## 循環分解定理\(cyclic decomposition theorem\)

> 線性轉換$$T \in L(V,V)$$為具指標$$k$$的冪零算子，即$$\forall v \in V, ~ T^k (v)=T^{k+1} (v)=\dots=0$$。
>
> 則唯一存在$$v_1,v_2,\dots,v_r \in V \ni V=C_{v_1} (T) \oplus C_{v_2} (T) \oplus \dots \oplus C_{v_r} (T)$$，即相同的冪零算子$$T$$，對於不同的向量$$v_i$$ 均可產生獨立的循環子空間$$C_{v_i} (T)$$，其直和為$$V$$。

> * 其中$$\dim⁡(C_{v_i} (T))=n_i,~ i=1,2,\dots,r, ~ n_1 \geq n_2 \geq \dots \geq n_r$$
> * 且$$v_i \in ker⁡(T^{n_i} )−ker⁡(T^{n_i−1} ), ~ i=1,2,\dots,r$$
> * $$\dim⁡(ker⁡(T))=r$$ \(循環子空間的個數\), $$k=n_1$$ \(冪零算子$$T$$的指標\)。

* 因為$$V$$是由獨立子空間$$C_{v_i} (T), ~i=1,2,\dots,r$$直和所組成，所以$$V$$的基底是由$$C_{v_i} (T)$$的基底聯集組成 。
* $$B_i=\{v_i, T(v_i ),T^2 (v_i ),\dots\}$$為$$C_{v_i} (T)$$的基底，則$$B=B_1 \cup B_2 \cup \dots \cup B_r$$ 為$$B$$的一組基底。
* $$因為C_{v_i} (T)$$為$$T$$不變子空間且$$V$$為$$C_{v_i} (T)$$的直和空間，所以根據定理可得：
* $$[T]_B =\begin{bmatrix}  [T_{C_{v_1}}]_{B_1}& 0& \dots & 0 \\ 0 &  [T_{C_{v_2}}]_{B_2} & \dots & 0 \\ \vdots & \vdots & \ddots & \vdots \\ 0 & 0 & \dots & [T_{C_{v_r}}]_{B_r} \end{bmatrix}  =\begin{bmatrix}  S_{n_1}& 0& \dots & 0 \\ 0 &  S_{n_2} & \dots & 0 \\ \vdots & \vdots & \ddots & \vdots \\ 0 & 0 & \dots & S_{n_r} \end{bmatrix}  $$
* 其中$$S_{n_i} \in F^{n_i \times n_i}$$為下移矩陣。
* 因為通常無法直接得出循環子空間的維度$$n_1,n_2, \dots ,n_r$$，所以先算出$$\dim⁡(ker⁡(T) ),\dim⁡(ker⁡(T^2 ) ), \dots$$後，再用點圖反推出$$n_1,n_2,\dots,n_r $$。

#### 將循環子空間的基底排列如下，稱為點圖\(dot diagram\)

$$\begin{vmatrix} B_1 \\ B_2 \\ \vdots \\ B_r \end{vmatrix} \Rightarrow \begin{vmatrix} v_1 & T(v_1) & T^2(v_1) & T^3(v_1) & T^4(v_1) & \dots &T^{n_1-1}(v_1) \\ & v_2 & T(v_2) & T^2(v_2) & T^3(v_2) & \dots & T^{n_2-1}(v_2) \\ & & \vdots & \vdots& \vdots & \ddots  & \vdots \\ && v_r & T(v_r) & T^2(v_r) & \dots & T^{n_r-1}(v_r) \end{vmatrix}$$



* 將所有循環子空間的基底$$B_i$$ 靠右對齊，因為只有最右邊那一行的$$r$$個元素$$\{T^{n_1−1} (v_1 ),T^{n_2−1} (v_2 ),\dots,T^{n_r−1} (v_r)\}$$經過一次$$T$$的轉換後會變成0向量。
* 即$$T(T^{n_1−1} (v_1 ))=T(T^{n_2−1} (v_2 ))=\dots=T(T^{n_r−1} (v_r ))=0$$
* 因此這$$r$$個向量為$$ker⁡(T)$$的基底，即$$ker⁡(T)=span\{T^{n_1−1} (v_1 ),T^{n_2−1} (v_2 ),\dots,T^{n_r−1} (v_r)\}$$, 且$$\dim⁡(ker⁡(T))=r$$
* 同理，點圖中最右邊第二行為$$ker⁡(T^2)$$的基底，最右邊第三行為$$ker⁡(T^3)$$的基底。
* 如果要把點圖中的所有元素均變為0向量，因為$$B_1$$的元素最多，因此至少須要$$n_1$$的轉換，即$$T^{n_1}=0$$，因此$$T$$為指標為$$n_1$$的冪零算子。

## 不變集\(invariant set\)

> 線性轉換$$T \in L(V,V)$$為具指標$$k$$的冪零算子\($$T^k=0$$\)，則循環分解定理\(cyclic decomposition theorem\)中每個循環子空間維度形成的有序集合$$\{n_1,n_2,\dots,n_r ~|~n_1 \geq n_2 \geq \dots \geq n_r \}$$稱為不變集。

#### 範例

* $$T\in L(V,V)$$為冪零算子，dim⁡\(V\)=20，且T的不變集為$$\{6,4,4,3,2,1\}$$，可得點圖如下：
* $$\begin{vmatrix} 6\rightarrow & v_1 & T(v_1) & T^2(v_1) & T^3(v_1) & T^4(v_1) & T^5(v_1)  \\ 4 \rightarrow & & & v_2 & T(v_2) & T^2 (v_2) & T^3(v_2) \\ 4 \rightarrow & & & v_3 & T(v_3) & T^2 (v_3) & T^3(v_3) \\ 3 \rightarrow & & & & &  v_5  &T(v_5) \\ 1 \rightarrow &&&&&&v_6\end{vmatrix}$$
* 所以$$\dim(ker(T))=6$$
* $$\dim(ker(T^2))=6+5=11$$
* $$\dim(ker(T^3))=6+5+4=15$$
* $$\dim(ker(T^4))=6+5+4+3=18$$
* $$\dim(ker(T^5))=6+5+4+3+1=19$$
* $$\dim(ker(T^6))=20=\dim(V)$$
* 所以$$T^6=0$$且$$T^5 \neq 0$$。
* 即$$T$$的指標為6，且$$T$$的循環分解為$$[T]_B=\begin{bmatrix}  S_6 &  & & & & 0 \\ & S_4 & & & & \\ & & S_4 & && \\ & & & S_3 & & \\ & & && S_2 & \\0 & & && & S_1  \end{bmatrix}$$

