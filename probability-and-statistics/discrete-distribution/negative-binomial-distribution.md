---
description: Negative binomial distribution
---

# 負二項分佈

## 簡介

負二項分佈是一種離散機率分佈，用來描述在獨立的重複Bernouli試驗中，直到第$$𝑟$$次成功發生時所需的總試驗次數$$X$$。換句話說：**要經歷多少次試驗，才會達到第**$$r$$**次成功？**

假設第$$r$$次成功前有$$k$$次失敗，因為到第$$r$$次成功就停止，因此總試驗次數為$$N=r+k-1$$，可得隨機變數$$X$$是第$$r$$次成功之前所經歷的失敗次數符從總試驗次數$$r+k-1$$次且成功機率為$$p$$的二項分佈。

這個分佈其實是**幾何分佈**的延伸：

* 幾何分佈是第一次成功要試幾次。
* 負二項分佈是第$$r$$次成功要試幾次。

負二項式分佈與二項分佈的區別在於：

* 二項分佈是固定試驗總次數$$N$$的獨立試驗中，成功次數$$k$$的機率分佈；
* 負二項分布是所有到成功$$r$$次時即終止的獨立試驗中，失敗次數$$k$$的機率分佈。

<mark style="color:red;">負二項分佈(</mark>變異數大於均值<mark style="color:red;">)可以用來模擬過度分散的計數資料(長尾現象)</mark>，<mark style="color:red;">這一點使其成為泊松分佈的一種擴充套件。當</mark>$$r \to \infty$$<mark style="color:red;">且</mark>$$p \to 1$$<mark style="color:red;">同時滿足</mark>$$r(1−p) \to \lambda$$ <mark style="color:red;">時，負二項分佈逼近泊松分佈</mark>。

| 特性         | 負二項分佈                             | 泊松分佈                              |
| ---------- | --------------------------------- | --------------------------------- |
| **隨機變數**   | 達到$$r$$次成功的試驗次數                   | 固定時間/空間內的事件計數                     |
| **變異數與均值** | $$\mathrm{Var}(X)>\mathrm{E}(X)$$ | $$\mathrm{Var}(X)=\mathrm{E}(X)$$ |
| **適用場景**   | 離散程度高的計數資料                        | 事件發生率穩定的稀有事件                      |

生物學與醫學：基因突變次數分析。傳染病發病率的建模（如COVID-19病例數預測）。

工程與可靠性分析：系統在故障前能承受的壓力測試次數。

經濟學與社會科學：客戶購買某商品的次數（直到達到促銷目標）。

生態學：動物覓食的成功次數與嘗試次數的關係。\


### 負二項分佈(失敗次數)

> \[標準定義]令隨機變數$$X$$表示在達到第$$r$$次成功之前所經歷的**失敗次數**，則$$X \sim NB(r, p)$$。此慮考慮的$$r \in \mathbb{N}$$的情形。
>
> 機率質量函數$$f(k | r,p)≡\mathrm{P}⁡(X=k)=\binom{k+r-1}{k}p^k(1-p)^r, ~ k=0,1,2,\ldots$$
>
> * 已知一個事件在Bernouli試驗中每次的出現機率是$$p$$，在一連串試驗中，一件事件剛好在第$$r+k$$次試驗出現第$$r$$次成功的機率。
> * $$r>0$$是成功的目標次數。
> * $$k$$是達到第$$r$$次成功之前的失敗次數。
> * 已確定第$$r+k$$次試驗為成功，所以第1次至第$$r+k-1$$次試驗所有可能的情形為$$r−1$$次成功與$$k$$次失敗試驗的排列組合，共有$$\binom{r+k-1}{k}$$種組合。

$$r$$可以是正整數或任意正實數。當$$r$$是正整數時，負二項分佈對應於經典的達到 r 次成功的模型。

當$$r=1$$時，負二項分佈退化為幾何分佈（Geometric Distribution），即第一次成功所需的試驗次數。

期望值：$$\mathrm{E}(X)=\frac{r(1-p)}{p}$$。

變異數：$$\mathrm{Var}(X)=\frac{r(1-p)}{p^2}$$。

## 負二項分佈(總試驗次數)

> 如果將$$X$$定義為達到第$$r$$次成功所需的**總試驗次數** （而非僅限於失敗次數），則總試驗次數$$Y=X+r$$的機率質量函數為：$$\mathrm{P}(Y=n)=\binom{n-1}{r-1}p^{r}(1-p)^{n-r}, n=r, r+1, r+2, \dots$$。
>
> 其中$$n$$為第$$r$$次成功的總試驗次數，因此在$$n-1$$次試驗中，為$$r-1$$次成功和$$n-r$$次失數的排列組合，共有$$\binom{n-1}{r-1}$$種組合。

期望值：$$\mathrm{E}(Y)=\frac{r}{p}$$。

變異數：$$\mathrm{Var}(X)=\frac{r(1-p)}{p^2}$$。變異數隨著𝑝減小（失敗機率增大）而變大。

負二項分佈可以視為$$r$$個獨立幾何分佈的總和。其中每次成功所需的試驗次數平均為$$1/p$$次。因此$$r$$次成功需$$r/p$$次試驗。

##
